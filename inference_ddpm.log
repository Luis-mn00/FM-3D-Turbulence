nohup: ignoring input
/home/navarro/anaconda3/envs/fm3d/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
Loading config...
cuda:3
N_time: 500, N_channels: 3, Nx: 128, Ny: 128, Nz: 128
Loading model...
/home/navarro/anaconda3/envs/fm3d/lib/python3.10/site-packages/torch/functional.py:554: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4314.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Sample 1/50
Plot saved in generated_plots/super_interp_ddpm_0.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 2/50
Plot saved in generated_plots/super_interp_ddpm_1.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 3/50
Plot saved in generated_plots/super_interp_ddpm_2.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 4/50
Plot saved in generated_plots/super_interp_ddpm_3.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 5/50
Plot saved in generated_plots/super_interp_ddpm_4.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 6/50
Plot saved in generated_plots/super_interp_ddpm_5.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 7/50
Plot saved in generated_plots/super_interp_ddpm_6.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 8/50
Plot saved in generated_plots/super_interp_ddpm_7.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 9/50
Plot saved in generated_plots/super_interp_ddpm_8.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 10/50
Plot saved in generated_plots/super_interp_ddpm_9.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 11/50
Plot saved in generated_plots/super_interp_ddpm_10.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 12/50
Plot saved in generated_plots/super_interp_ddpm_11.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 13/50
Plot saved in generated_plots/super_interp_ddpm_12.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 14/50
Plot saved in generated_plots/super_interp_ddpm_13.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 15/50
Plot saved in generated_plots/super_interp_ddpm_14.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 16/50
Plot saved in generated_plots/super_interp_ddpm_15.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 17/50
Plot saved in generated_plots/super_interp_ddpm_16.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 18/50
Plot saved in generated_plots/super_interp_ddpm_17.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 19/50
Plot saved in generated_plots/super_interp_ddpm_18.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 20/50
Plot saved in generated_plots/super_interp_ddpm_19.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 21/50
Plot saved in generated_plots/super_interp_ddpm_20.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 22/50
Plot saved in generated_plots/super_interp_ddpm_21.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 23/50
Plot saved in generated_plots/super_interp_ddpm_22.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 24/50
Plot saved in generated_plots/super_interp_ddpm_23.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 25/50
Plot saved in generated_plots/super_interp_ddpm_24.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 26/50
Plot saved in generated_plots/super_interp_ddpm_25.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 27/50
Plot saved in generated_plots/super_interp_ddpm_26.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 28/50
Plot saved in generated_plots/super_interp_ddpm_27.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 29/50
Plot saved in generated_plots/super_interp_ddpm_28.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 30/50
Plot saved in generated_plots/super_interp_ddpm_29.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 31/50
Plot saved in generated_plots/super_interp_ddpm_30.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 32/50
Plot saved in generated_plots/super_interp_ddpm_31.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 33/50
Plot saved in generated_plots/super_interp_ddpm_32.png
Loading model from LSIM_3D/models/VolSiM.pth
Sample 34/50
Plot saved in generated_plots/super_interp_ddpm_33.png
Loading model from LSIM_3D/models/VolSiM.pth
Traceback (most recent call last):
  File "/home/navarro/FM-3D-Turbulence/inference_super_ddpm.py", line 270, in <module>
    ddpm_interp_sparse_experiment(dataset, config, model, num_samples, samples_x, samples_y, reverse_steps=50)
  File "/home/navarro/FM-3D-Turbulence/inference_super_ddpm.py", line 116, in ddpm_interp_sparse_experiment
    lsim.append(utils.LSiM_distance_3D(y, y_pred))
  File "/home/navarro/FM-3D-Turbulence/utils.py", line 292, in LSiM_distance_3D
    dist = model_3d.computeDistance(A, B, normalize=True, interpolate=False)
  File "/home/navarro/FM-3D-Turbulence/LSIM_3D/src/volsim/distance_model.py", line 231, in computeDistance
    output = self(sample)
  File "/home/navarro/anaconda3/envs/fm3d/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/navarro/anaconda3/envs/fm3d/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/navarro/FM-3D-Turbulence/LSIM_3D/src/volsim/distance_model.py", line 182, in forward
    normalized1 = self.normalizeTensor(outBaseA[i], i)
  File "/home/navarro/FM-3D-Turbulence/LSIM_3D/src/volsim/distance_model.py", line 304, in normalizeTensor
    normalized = (tensorIn - mean.expand_as(tensorIn)) / (std.expand_as(tensorIn) + epsilon)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 32.00 MiB. GPU 0 has a total capacity of 44.52 GiB of which 13.25 MiB is free. Process 133198 has 42.04 GiB memory in use. Process 194365 has 496.00 MiB memory in use. Process 195192 has 702.00 MiB memory in use. Process 195792 has 498.00 MiB memory in use. Including non-PyTorch memory, this process has 804.00 MiB memory in use. Of the allocated memory 258.72 MiB is allocated by PyTorch, and 49.28 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
